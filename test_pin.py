

# # b8 0e 2a aa d5 1c 51 9a
# # 5591 1335 9475

# # 00 00 55 91 13 35 94 75
# # 04 12 34 ff ff ff ff ff 

# # 04 12 61 6e ec ca 6b 8a

# pin_encrypted = [0xb8, 0x0e, 0x2a, 0xaa, 0xd5, 0x1c, 0x51, 0x9a]
pan = [0x00, 0x00, 0x55, 0x91, 0x13, 0x35, 0x94, 0x75]
# pan2 = [0x43, 0x45, 0x59, 0x11, 0x33, 0x59, 0x47, 0x58]
# pinblock = [0x04, 0x12, 0x34, 0xff, 0xff, 0xff, 0xff, 0xff]

# 4e 70 ba 90 35 78 92 1d
pin_encrypted = [0x4e, 0x70, 0xba, 0x90, 0x35, 0x78, 0x92, 0x1d]
pinblock = [0x06, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff]


#pin original: 123456 | encriptado: b6 23 60 bc 5b 60 fd a4
#tarjeta 4757 7416 6430 7226
#pan interceptado 7741 6643 0722
pin_encrypted = [0xb6, 0x23, 0x60, 0xbc, 0x5b, 0x60, 0xfd, 0xa4]
pan = [0x00, 0x00, 0x77, 0x41, 0x66, 0x43, 0x07, 0x22]
pinblock = [0x06, 0x12, 0x34, 0x56, 0xff, 0xff, 0xff, 0xff]


# card no: 4000012809785411 (blanca clerticket)
# 00 12 80 97 85 41
pan = [0x00, 0x00, 0x00, 0x12, 0x80, 0x97, 0x85, 0x41]
# fef564bb97fc8fc6
pin_encrypted = [0xfe, 0xf5, 0x64, 0xbb, 0x97, 0xfc, 0x8f, 0xc6]
for i in range(8):
    print(hex(pan[i] ^ pinblock[i]), end=" ")

# # card no: 4345591133594758
# # 55 91 13 35 94 75
# pan = [0x00, 0x00, 0x55, 0x91, 0x13, 0x35, 0x94, 0x75]
# # card pin: 6f97ecdcbf0b3809
# pin_encrypted = [0x6f, 0x97, 0xec, 0xdc, 0xbf, 0x0b, 0x38, 0x09]
# print()
# for i in range(8):
#     print(hex(pan[i] ^ pin_encrypted[i]), end=" ")


#For extracting PAN from debit card number we do as the SDK document says: "extract 12 characters from the second character left to ‘＝ ’ of track2"
#So, we have a card number 4000012809785411 and we take 001280978541 as PAN
#The PAN used to encrypt PIN should be then [0x00, 0x00, 0x00, 0x12, 0x80, 0x97, 0x85, 0x41]
#The PIN in plain text is "123456"
#So the pinblock should be [0x06, 0x12, 0x34, 0x56, 0xff, 0xff, 0xff, 0xff]
#Executing xor operation between PAN and PINBLOCK results in [0x6, 0x12, 0x34, 0x44, 0x7f, 0x68, 0x7a, 0xbe]
#We suspect that executing "result.get('pin')" after "result = deviceApi.readCard(...)" returns PINBLOCK mentionend in the sdk documentation pdf section "7. Appendix A: Method of encryption and decryption for PIN"
#The value returned by "result.get('pin')" is "fef564bb97fc8fc6", that is far different from the xor operation result por encryption. I hope you can guide us.